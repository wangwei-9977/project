(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68a91f16"],{2076:function(e,t,o){"use strict";var n=o("c7eb"),r=o("1da1"),s=o("2638"),a=o.n(s),i=o("5530"),l=(o("d81d"),o("b64b"),o("c740"),o("f092")),c=o("d4e0"),d=o("2ae7"),u=o("ed08");t["a"]={components:{normalTableRender:{functional:!0,name:"normal-table-render",render:function(e,t){return t.parent.tableRender(t)}},ProTable:l["a"],DialogForm:c["a"],ToobarButton:d["a"]},data:function(){return{selectionList:[],searchModel:{},searchConfig:[],toolbarConfig:[],actionConfig:[],tableColumns:[],tableProps:{},checkbox:!1,showIndex:!1,showToolbar:!0,pagination:!0,dialogTitle:"新增",dialogWidth:"600px",dialogLabelWidth:"80px",dialogVisible:!1,dialogFormConfig:[],formModel:{},formRules:{},tableData:null,dictHandle:Object(u["c"])(this.dictWithData,1e3)}},watch:{"dict.type":{handler:function(){this.dictHandle()},deep:!0}},methods:{tableRender:function(e){var t=this,o=this.$createElement,n=e.slots();return o("div",[o("pro-table",a()([{ref:"tableRef",attrs:{data:this.tableData,"search-model":this.searchModel,"search-config":this.searchConfig,"toolbar-config":this.toolbarConfig,"table-props":this.tableProps,"table-columns":this.tableColumns,checkbox:this.checkbox,request:this.request,showIndex:this.showIndex,showToolbar:this.showToolbar,pagination:this.pagination,resetHandle:this.resetHandle,searchHandle:this.searchHandle},on:{buttonClick:this.buttonClick,handleSelectionChange:this.handleSelectionChange}},{scopedSlots:Object(i["a"])({actions:function(e,n){return o("div",{style:{display:"flex","justify-content":"center",width:"100%"}},[o("toobar-button",{attrs:{config:t.actionConfig,data:n},on:{buttonClick:function(o){t.actionClick(o,n,e.$index)}}})])}},e.scopedSlots)}]),[Object.keys(n).map((function(e){return o("template",{slot:e},[n[e]])}))]),o("dialog-form",a()([{attrs:{title:this.dialogTitle,width:this.dialogWidth,"label-width":this.dialogLabelWidth,configs:this.dialogFormConfig,dialogVisible:this.dialogVisible,"form-model":this.formModel,"form-rules":this.formRules},on:{close:this.closeDialog,confirm:this.confirm}},{scopedSlots:e.scopedSlots}]))])},getDictValue:function(e,t){var o,n;return null!==(o=this.dict)&&void 0!==o&&o.type[e]?null===(n=this.dict)||void 0===n?void 0:n.label[e][t]:""},setDictValue:function(e){var t,o,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value";return null!==(t=this.dict)&&void 0!==t&&t.type[e]?null===(o=this.dict)||void 0===o?void 0:o.type[e].map((function(e){return{label:e[n],value:e[r]}})):[]},getOptionsByDict:function(e,t){var o=this.searchConfig.findIndex((function(t){return t.model===e}));-1!==o&&(this.searchConfig[o].options=this.setDictValue(t))},closeDialog:function(){this.dialogVisible=!1},confirm:function(e){this.dialogVisible=!1},reload:function(){this.selectionList=[],this.$refs.tableRef&&this.$refs.tableRef.reload()},request:function(){return Object(r["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{list:[],total:0});case 1:case"end":return e.stop()}}),e)})))()},buttonClick:function(){},handleSelectionChange:function(e){this.selectionList=e},dictWithData:function(){},actionClick:function(){},resetHandle:function(){},searchHandle:function(){}}}},3528:function(e,t,o){"use strict";o.d(t,"k",(function(){return r})),o.d(t,"j",(function(){return s})),o.d(t,"a",(function(){return a})),o.d(t,"m",(function(){return i})),o.d(t,"g",(function(){return l})),o.d(t,"f",(function(){return c})),o.d(t,"h",(function(){return d})),o.d(t,"b",(function(){return u})),o.d(t,"l",(function(){return p})),o.d(t,"c",(function(){return f})),o.d(t,"d",(function(){return m})),o.d(t,"e",(function(){return h})),o.d(t,"i",(function(){return b}));var n=o("b775");function r(e){return Object(n["a"])({url:"/system/role/list",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/system/role/"+e,method:"get"})}function a(e){return Object(n["a"])({url:"/system/role",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/system/role",method:"put",data:e})}function l(e){return Object(n["a"])({url:"/system/role/dataScope",method:"put",data:e})}function c(e,t){var o={roleId:e,status:t};return Object(n["a"])({url:"/system/role/changeStatus",method:"put",data:o})}function d(e){return Object(n["a"])({url:"/system/role/"+e,method:"delete"})}function u(e){return Object(n["a"])({url:"/system/role/authUser/allocatedList",method:"get",params:e})}function p(e){return Object(n["a"])({url:"/system/role/authUser/unallocatedList",method:"get",params:e})}function f(e){return Object(n["a"])({url:"/system/role/authUser/cancel",method:"put",data:e})}function m(e){return Object(n["a"])({url:"/system/role/authUser/cancelAll",method:"put",params:e})}function h(e){return Object(n["a"])({url:"/system/role/authUser/selectAll",method:"put",params:e})}function b(e){return Object(n["a"])({url:"/system/role/deptTree/"+e,method:"get"})}},"82f7":function(e,t,o){"use strict";o("870f")},"870f":function(e,t,o){},a66f:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"search"},[o("el-card",{staticStyle:{"margin-bottom":"10px"}},[o("p",{attrs:{slot:"header"},slot:"header"},[o("span",[e._v("流程审批进度历史")])]),o("el-row",{staticStyle:{position:"relative"}},[o("normal-table-render")],1)],1),o("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.callback},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{name:"1",label:"实时流程图"}},[o("el-card",[o("el-row",{staticStyle:{position:"relative"}},[o("img",{attrs:{src:e.imgUrl}})])],1)],1),e.lcModa?o("el-tab-pane",{attrs:{name:"2",label:"表单数据"}},[o("el-card",[o(e.lcModa.formComponent,{tag:"component",attrs:{disabled:e.lcModa.disabled,processData:e.lcModa.processData,isNew:e.lcModa.isNew,task:e.lcModa.isTask},on:{afterSubmit:e.afterSub,passTask:function(t){return e.pass(e.lcModa.processData)},backTask:function(t){return e.back(e.lcModa.processData)},close:function(t){e.lcModa.visible=!1,e.lcModa.disabled=!1}}})],1)],1):e._e()],1)],1)},r=[],s=o("c7eb"),a=o("1da1"),i=(o("a15b"),o("d81d"),o("d3b7"),o("25f0"),o("2076")),l=o("b775"),c=o("ed08"),d={name:"HistoryDetail",mixins:[i["a"]],props:{procInstId:{type:String,default:"",required:!0},lcModa:{type:Object,required:!1}},data:function(){var e=this.$createElement;return{activeName:"1",url:{historicFlow:"/system/actTask/historicFlow/",getHighlightImg:"/prod-api/system/activiti/models/getHighlightImg/"},type:0,loading:!1,loadingImg:!1,id:"",imgUrl:"",backRoute:"",pagination:!1,dialogVisible:!1,showToolbar:!1,tableColumns:[{key:"name",title:"任务名称"},{key:"assignees",title:"处理人",customRender:function(t,o){var n=o.assignees||[],r=n.map((function(e){return e.username})).join(",");return e("span",[r])}},{key:"deleteReason",title:"审批操作",customRender:function(t,o){return e("div",[o.deleteReason.toString().indexOf("通过")>-1?e("span",{style:"color: #00DB00"},[o.deleteReason]):o.deleteReason.toString().indexOf("驳回")>-1?e("span",{style:"color: red;"},[o.deleteReason]):e("span",[o.deleteReason])])}},{key:"comment",title:"审批意见"},{key:"duration",title:"耗时",customRender:function(t,o){return e("span",[Object(c["h"])(o.duration)])}},{key:"createTime",title:"创建时间",props:{width:160}},{key:"endTime",title:"完成时间",props:{width:160}},{key:"status",title:"状态",customRender:function(t,o){return e("div",[o.endTime?e("span",{style:"color: blue;"},["已办理"]):e("span",{style:"color: #999999"},["待处理"])])}}]}},created:function(){this.init()},watch:{procInstId:function(e,t){this.init()}},methods:{loadData:function(){},init:function(){this.id=this.procInstId,this.imgUrl=this.url.getHighlightImg+this.id+"?time="+new Date,this.reload()},request:function(){var e=this;return Object(a["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(l["a"])({url:e.url.historicFlow+e.id,method:"get"}).then((function(t){return 200===t.code?t.data&&0!=t.data.length||e.$message.info("未找到该记录审批历史数据,历史数据可能已被删除"):e.$message.error(t.msg),{list:t.data||[],total:0}})));case 1:case"end":return t.stop()}}),t)})))()},callback:function(e,t){console.log(e,t,this.activeName)},afterSub:function(){},pass:function(e){this.$emit("passTask",e)},back:function(e){this.$emit("backTask",e)}}},u=d,p=o("2877"),f=Object(p["a"])(u,n,r,!1,null,null,null);t["a"]=f.exports},c0c7:function(e,t,o){"use strict";o.d(t,"h",(function(){return s})),o.d(t,"f",(function(){return a})),o.d(t,"a",(function(){return i})),o.d(t,"k",(function(){return l})),o.d(t,"c",(function(){return c})),o.d(t,"i",(function(){return d})),o.d(t,"b",(function(){return u})),o.d(t,"g",(function(){return p})),o.d(t,"l",(function(){return f})),o.d(t,"m",(function(){return m})),o.d(t,"n",(function(){return h})),o.d(t,"e",(function(){return b})),o.d(t,"j",(function(){return g})),o.d(t,"d",(function(){return v}));var n=o("b775"),r=o("c38a");function s(e){return Object(n["a"])({url:"/system/user/list",method:"get",params:e})}function a(e){return Object(n["a"])({url:"/system/user/"+Object(r["e"])(e),method:"get"})}function i(e){return Object(n["a"])({url:"/system/user",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/system/user",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/system/user/"+e,method:"delete"})}function d(e,t){var o={userId:e,password:t};return Object(n["a"])({url:"/system/user/resetPwd",method:"put",data:o})}function u(e,t){var o={userId:e,status:t};return Object(n["a"])({url:"/system/user/changeStatus",method:"put",data:o})}function p(){return Object(n["a"])({url:"/system/user/profile",method:"get"})}function f(e){return Object(n["a"])({url:"/system/user/profile",method:"put",data:e})}function m(e,t){var o={oldPassword:e,newPassword:t};return Object(n["a"])({url:"/system/user/profile/updatePwd",method:"put",params:o})}function h(e){return Object(n["a"])({url:"/system/user/profile/avatar",method:"post",data:e})}function b(e){return Object(n["a"])({url:"/system/user/authRole/"+e,method:"get"})}function g(e){return Object(n["a"])({url:"/system/user/authRole",method:"put",params:e})}function v(){return Object(n["a"])({url:"/system/user/deptTree",method:"get"})}},d3f4:function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"content"},[o("normal-table-render",{scopedSlots:e._u([{key:"formtype",fn:function(t,n){return[o("a",{style:{color:e.styles.theme},on:{click:e.viewForm}},[e._v("预览表单")])]}}])}),o("Dialog",{attrs:{title:"流程图片预览",width:"90%",footer:!1,visible:e.imageVisible},on:{close:function(t){e.imageVisible=!1}}},[o("img",{attrs:{src:e.diagramUrl}})]),o("Dialog",{attrs:{title:"流程表单预览",width:"50%",footer:!1,visible:e.formVisible},on:{close:function(t){e.formVisible=!1}}},[o(e.formComponent,{tag:"component",attrs:{isNew:!0,disabled:!0}})],1),o("Dialog",{attrs:{visible:e.showProcessNodeEdit,title:"编辑流程节点",width:"800px"},on:{close:e.processClose}},[o("el-row",[o("el-col",{attrs:{span:4}},[o("el-steps",{staticClass:"step",attrs:{direction:"vertical",active:e.active}},e._l(e.nodeList,(function(e,t){return o("el-step",{key:t,attrs:{title:e.title,description:e.description,"data-id":t}})})),1)],1),o("el-col",{attrs:{span:20}},[o("div",{staticClass:"step-content"},[o("el-alert",{attrs:{title:"温馨提示：若流程运行至未分配审批人员的审批节点时，流程将自动中断取消！",type:"warning","show-icon":"",closable:!1}}),o("el-form",{ref:"formRef",attrs:{rules:e.processRules,model:e.processModel,"label-width":"120px"}},[o("el-form-item",{attrs:{label:"节点名称"}},[o("span",{staticClass:"nodespan"},[e._v(e._s(e.editNode.title))])]),o("el-form-item",{attrs:{label:"节点类型"}},[o("span",{staticClass:"nodespan"},[e._v(e._s(e.dictNodeType[e.editNode.type]))])]),o("el-alert",{attrs:{title:"每个节点设置，如有修改都请保存一次，跳转节点后数据不会自动保存！",type:"info","show-icon":"",closable:!1}}),o("br"),o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.editNode.type,expression:"editNode.type === 1"}],attrs:{prop:"approve",label:"审批人员"}},[o("el-checkbox-group",{on:{change:e.checkChange},model:{value:e.processModel.approve,callback:function(t){e.$set(e.processModel,"approve",t)},expression:"processModel.approve"}},[o("el-checkbox",{attrs:{label:"0"}},[e._v("根据角色选择")]),o("el-checkbox",{attrs:{label:"1"}},[e._v("直接选择人员")]),o("el-checkbox",{attrs:{label:"2"}},[e._v("部门")]),o("el-checkbox",{attrs:{label:"5"}},[e._v("部门负责人")]),o("el-checkbox",{attrs:{label:"3"}},[e._v(" 发起人 "),o("el-tooltip",{attrs:{placement:"top",content:"自动获取发起人"}},[o("i",{staticClass:"el-icon-warning-outline"})])],1),o("el-checkbox",{attrs:{label:"4"}},[e._v(" 发起人的部门负责人 "),o("el-tooltip",{attrs:{placement:"top",content:"自动获取发起人所在部门的负责人，即其上级领导。（如果其本身就是部门负责人，则指向发起人自己。）"}},[o("i",{staticClass:"el-icon-warning-outline"})])],1),o("el-checkbox",{attrs:{label:"6"}},[e._v(" 表单变量 "),o("el-tooltip",{attrs:{placement:"top",content:"填写与表单中相对应的变量，role:角色，user:人员：dept:部门：deptManage:部门负责人; 例如：variable:role,variable2:user;"}},[o("i",{staticClass:"el-icon-warning-outline"})])],1)],1)],1),e.processModel.approve.indexOf("0")>-1?o("el-form-item",{attrs:{label:"选择角色"}},[o("el-select",{attrs:{multiple:"",clearable:"",collapseTags:""},model:{value:e.processModel.roleIds,callback:function(t){e.$set(e.processModel,"roleIds",t)},expression:"processModel.roleIds"}},e._l(e.roleOptions,(function(e,t){return o("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1):e._e(),e.processModel.approve.indexOf("1")>-1?o("el-form-item",{attrs:{label:"选择人员"}},[o("el-select",{attrs:{multiple:"",clearable:"",collapseTags:""},model:{value:e.processModel.userIds,callback:function(t){e.$set(e.processModel,"userIds",t)},expression:"processModel.userIds"}},e._l(e.userOptions,(function(e,t){return o("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1):e._e(),e.processModel.approve.indexOf("2")>-1?o("el-form-item",{attrs:{label:"选择部门"}},[o("treeselect",{attrs:{options:e.deptOptions,normalizer:e.normalizer,clearable:"",multiple:"",placeholder:"选择部门"},model:{value:e.processModel.departmentIds,callback:function(t){e.$set(e.processModel,"departmentIds",t)},expression:"processModel.departmentIds"}})],1):e._e(),e.processModel.approve.indexOf("5")>-1?o("el-form-item",{attrs:{label:"选择部门负责人"}},[o("treeselect",{attrs:{options:e.deptOptions,normalizer:e.normalizer,clearable:"",multiple:"",placeholder:"选择部门"},model:{value:e.processModel.departmentManageIds,callback:function(t){e.$set(e.processModel,"departmentManageIds",t)},expression:"processModel.departmentManageIds"}})],1):e._e(),e.processModel.approve.indexOf("6")>-1?o("el-form-item",{attrs:{label:"输入表单变量"}},[o("el-input",{model:{value:e.processModel.formVariables,callback:function(t){e.$set(e.processModel,"formVariables",t)},expression:"processModel.formVariables"}})],1):e._e()],1)],1)])],1),o("template",{slot:"footer"},[o("el-button",{attrs:{loading:e.confirmLoading,disabled:e.disabled,type:"primary"},on:{click:e.processConfirm}},[e._v(" 确定 ")]),o("el-button",{attrs:{type:"gray"},on:{click:e.processClose}},[e._v(" 取消 ")])],1)],2)],1)},r=[],s=o("b85c"),a=o("5530"),i=o("c7eb"),l=o("1da1"),c=(o("d81d"),o("d3b7"),o("159b"),o("b0c0"),o("a9e3"),o("14d9"),o("99af"),o("ca17")),d=o.n(c),u=(o("542c"),o("2076")),p=o("9039"),f=o("49f4"),m=o.n(f),h=o("f8ab"),b=o("b775");function g(e){return Object(b["a"])({url:"/system/activiti_process/listData",method:"get",params:e})}function v(e){return Object(b["a"])({url:"/system/activiti_process/convertToModel",method:"post",data:e})}function y(e){return Object(b["a"])({url:"/system/activiti_process/delByIds",method:"DELETE",params:e})}function w(e){return Object(b["a"])({url:"/system/activiti_process/updateInfo",method:"post",data:e})}function k(e){return Object(b["a"])({url:"/system/activiti_process/updateStatus",method:"post",data:e})}function M(e){return Object(b["a"])({url:"/system/activiti_process/getProcessNode",method:"get",params:e})}function O(e){return Object(b["a"])({url:"/system/activiti_process/editNodeUser",method:"post",data:e})}var x=o("3528"),_=o("c0c7"),j=o("fcb7"),C={name:"ProcessModelList",mixins:[u["a"],h["a"]],components:{Dialog:p["a"],Treeselect:d.a},data:function(){var e=this,t=this.$createElement;return{styles:m.a,defaultUrl:"/prod-api",url:{img:"/system/activiti/models/export"},processModel:{approve:[],departmentManageIds:[]},processRules:{approve:[{required:!0,message:"请选择"}]},formComponent:null,active:1,nodeList:[],editNode:{},dictNodeType:{0:"开始节点",1:"审批节点",2:"结束节点"},roleOptions:[],userOptions:[],deptOptions:[],confirmLoading:!1,imageVisible:!1,formVisible:!1,showProcessNodeEdit:!1,doms:[],diagramUrl:"",dictOptions:[{text:"测试流程",label:"测试流程",value:"test"},{text:"OA办公",label:"OA办公",value:"oa"},{text:"业务办理",label:"业务办理",value:"business"}],searchConfig:[{type:"input",model:"lcmc",label:"流程名称"},{type:"input",model:"lckey",label:"流程标识"},{type:"switch",model:"zx",label:"是否最新"}],formRules:{categoryId:[{required:!0,message:"请选择"}],routeName:[{required:!0,message:"请选择"}]},dialogFormConfig:[{type:"select",label:"流程分类",model:"categoryId",options:[{label:"测试流程",value:"test"},{label:"OA办公",value:"oa"},{label:"业务办理",value:"business"}]},{type:"select",label:"关联表单",model:"routeName",scopedSlots:"formtype",options:[],change:function(t,o){e.formChange(t)}},{type:"select",label:"角色授权",model:"roles",options:[{label:"业务办理",value:"1"}]},{type:"inputNumber",label:"排序",model:"sort"},{type:"textarea",label:"备注描述",model:"description"}],actionConfig:[{label:function(e,t){return t.status?"禁用":"启用"},type:"text",icon:"el-icon-lock",action:"open"},{label:"节点设置",type:"text",icon:"el-icon-setting",action:"setup"},{label:"复制为模型",type:"text",icon:"el-icon-document-copy",action:"copy"},{label:"编辑",type:"text",icon:"el-icon-edit",action:"edit"},{label:"删除",type:"text",icon:"el-icon-delete",action:"del"}],tableColumns:[{key:"name",title:"流程名称",props:{width:"200",fixed:"left"}},{key:"processKey",title:"流程标识",props:{width:"200"}},{key:"version",title:"版本",props:{width:"100"}},{key:"categoryId",title:"所属分类",props:{width:"200"},customRender:function(o,n){return t("span",[e.filterDictText(e.dictOptions,n.categoryId)])}},{key:"diagramName",title:"流程图片",props:{width:"200"},customRender:function(o,n,r){return t("a",{style:{color:m.a.theme},on:{click:function(){return e.showResource(n)}}},[n.diagramName])}},{key:"routeName",title:"表单路由",props:{width:"200"},customRender:function(o,n,r){return t("a",{style:{color:m.a.theme},on:{click:function(){return e.viewForm(n)}}},[e.getFormComponent(n.routeName).text])}},{key:"status",title:"状态",props:{width:"200"},customRender:function(e,o,n){return t("div",[o.status?t("span",{style:"color: #00A0E9;"},["已启用"]):t("span",{style:"color: #999;"},["未启用"])])}},{key:"description",title:"备注说明",props:{width:"300"}},{key:"createTime",title:"部署时间",props:{width:"160"}},{key:"updateTime",title:"更新时间",props:{width:"160"}},{key:"action",title:"操作",props:{align:"center",minWidth:"340",fixed:"right"},scopedSlots:{customRender:"actions"}}]}},computed:{disabled:function(){return 0==this.editNode.type||2==this.editNode.type}},created:function(){var e=this;Object(x["k"])({pageNum:1,pageSize:1e4}).then((function(t){var o=t.rows||[],n=o.map((function(e){return{label:e.roleName,value:e.roleId}}));e.roleOptions=n})),Object(_["h"])({pageNum:1,pageSize:1e4}).then((function(t){var o=t.rows||[],n=o.map((function(e){return{label:e.userName,value:e.userId}}));e.userOptions=n})),Object(j["d"])().then((function(t){e.deptOptions=e.handleTree(t.data,"deptId")})),this.dialogFormConfig[1].options=this.allFormComponent.map((function(e){return{label:e.text,value:e.routeName}}))},methods:{normalizer:function(e){return e.children&&!e.children.length&&delete e.children,{id:e.deptId,label:e.deptName,children:e.children,isDefaultExpanded:!0}},request:function(e){return Object(l["a"])(Object(i["a"])().mark((function t(){var o;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g(e);case 2:return o=t.sent,t.abrupt("return",{list:o.data});case 4:case"end":return t.stop()}}),t)})))()},actionClick:function(e,t){var o=this;switch(e.action){case"open":this.$modal.confirm("您确认要".concat(t.status?"禁用":"启用","吗？")).then((function(){var e={status:t.status?0:1,id:t.id};k(e).then((function(e){o.reload(),o.$modal.msgSuccess("操作成功")}))}));break;case"setup":M({id:t.id}).then((function(e){o.nodeList=e.data||[],o.editNode=o.nodeList[o.active-1],o.active=1,o.processModel={approve:[]},o.showProcessNodeEdit=!0,o.$nextTick((function(){o.doms=document.querySelectorAll(".el-step"),o.doms.forEach((function(e){e.addEventListener("click",o.stepClick)}))}))}));break;case"copy":this.$modal.confirm("您确认要转化流程".concat(t.name,"为模型吗？")).then((function(){v({id:t.id}).then((function(e){o.reload(),that.$modal.msgSuccess("转化成功")}))}));break;case"edit":this.dialogTitle="编辑流程",this.formModel=Object(a["a"])({},t),this.formChange(t.routeName),this.dialogVisible=!0;break;case"del":this.$modal.confirm("您确认要删除流程吗？").then((function(){y({ids:t.id}).then((function(e){o.reload(),o.$modal.msgSuccess("删除成功")}))}));break}},stepClick:function(e){var t=this,o=e.currentTarget.getAttribute("data-id");this.active=Number(o)+1,this.editNode=this.nodeList[o],this.processModel={approve:[],userIds:[],roleIds:[],departmentIds:[],departmentManageIds:[],formVariables:"",chooseSponsor:!1,chooseDepHeader:!1},this.$nextTick((function(){t.$refs.formRef.resetFields(),t.change_steps(t.editNode)}))},change_steps:function(e){this.processModel.chooseDepHeader=e.chooseDepHeader||!1,this.processModel.chooseDepHeader&&this.processModel.approve.push("4"),this.processModel.chooseSponsor=e.chooseSponsor||!1,this.processModel.chooseSponsor&&this.processModel.approve.push("3");var t,o=[],n=Object(s["a"])(e.users||[]);try{for(n.s();!(t=n.n()).done;){var r=t.value;o.push(r.userName)}}catch(v){n.e(v)}finally{n.f()}this.processModel.userIds=o,o.length>0&&this.processModel.approve.push("1");var a,i=[],l=Object(s["a"])(e.roles||[]);try{for(l.s();!(a=l.n()).done;){var c=a.value;i.push(c.roleKey)}}catch(v){l.e(v)}finally{l.f()}this.processModel.roleIds=i,i.length>0&&this.processModel.approve.push("0");var d,u=[],p=Object(s["a"])(e.departments||[]);try{for(p.s();!(d=p.n()).done;){var f=d.value;u.push(f.deptId)}}catch(v){p.e(v)}finally{p.f()}this.processModel.departmentIds=u,u.length>0&&this.processModel.approve.push("2");var m,h=[],b=Object(s["a"])(e.departmentManages||[]);try{for(b.s();!(m=b.n()).done;){var g=m.value;h.push(g.deptId)}}catch(v){b.e(v)}finally{b.f()}this.processModel.departmentManageIds=h,h.length>0&&this.processModel.approve.push("5"),this.processModel.formVariables=e.formVariables||"",this.processModel.formVariables&&this.processModel.approve.push("6")},checkChange:function(e){-1===this.processModel.approve.indexOf("0")&&(this.processModel.roleIds=[]),-1===this.processModel.approve.indexOf("1")&&(this.processModel.userIds=[]),-1===this.processModel.approve.indexOf("2")&&(this.processModel.departmentIds=[]),-1===this.processModel.approve.indexOf("5")&&(this.processModel.departmentManageIds=[]),-1===this.processModel.approve.indexOf("6")&&(this.processModel.formVariables=""),this.processModel.chooseSponsor=this.processModel.approve.indexOf("3")>-1,this.processModel.chooseDepHeader=this.processModel.approve.indexOf("4")>-1},confirm:function(e){var t=this;w(e).then((function(e){t.$modal.msgSuccess("编辑成功"),t.dialogVisible=!1,t.refresh()}))},showResource:function(e){this.diagramUrl="".concat(this.defaultUrl).concat(this.url.img,"?id=").concat(e.id),this.imageVisible=!0},formChange:function(e){var t=this.getFormComponent(e);this.formModel.businessTable=t.businessTable},viewForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.routeName;if(t||(t=this.formModel.routeName),!t)return this.$modal.msgWarning("请先选择表单!");this.formComponent=this.getFormComponent(t).component,this.formVisible=!0},processConfirm:function(){var e=this;this.$refs.formRef.validate((function(t){if(t){var o=Object(a["a"])({},e.processModel);e.confirmLoading=!0,o.nodeId=e.editNode.id,o.procDefId=e.editNode.procDefId,O(o).then((function(t){e.reload(),e.$modal.msgSuccess("操作成功")})),e.confirmLoading=!1,e.showProcessNodeEdit=!0}}))},processClose:function(){var e=this;this.active=1,this.doms.forEach((function(t){t.removeEventListener("click",e.stepClick)})),this.$refs.formRef.resetFields(),this.showProcessNodeEdit=!1,this.doms=[],this.editNode={},this.confirmLoading=!1},filterDictText:function(e,t){if(e instanceof Array){var o,n=Object(s["a"])(e);try{for(n.s();!(o=n.n()).done;){var r=o.value;if(t===r.value)return r.label}}catch(a){n.e(a)}finally{n.f()}}return t}}},I=C,N=(o("82f7"),o("2877")),D=Object(N["a"])(I,n,r,!1,null,"343f4cc0",null);t["default"]=D.exports},ed08:function(e,t,o){"use strict";o.d(t,"e",(function(){return n})),o.d(t,"b",(function(){return r})),o.d(t,"g",(function(){return s})),o.d(t,"d",(function(){return a})),o.d(t,"a",(function(){return i})),o.d(t,"j",(function(){return l})),o.d(t,"f",(function(){return c})),o.d(t,"c",(function(){return d})),o.d(t,"i",(function(){return u})),o.d(t,"h",(function(){return p}));o("53ca"),o("ac1f"),o("5319"),o("14d9"),o("a15b"),o("d81d"),o("b64b"),o("d3b7"),o("159b"),o("fb6a"),o("d9e2"),o("a630"),o("3ca3"),o("6062"),o("ddb0"),o("25f0"),o("466d"),o("4d63"),o("c607"),o("2c3e"),o("00b4"),o("b680"),o("c38a");function n(e){if(null==e||""==e)return"";var t=new Date(e),o=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),a=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),i=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return o+"-"+n+"-"+r+" "+s+":"+a+":"+i}function r(e,t,o){var n,r,s,a,i,l=function l(){var c=+new Date-a;c<t&&c>0?n=setTimeout(l,t-c):(n=null,o||(i=e.apply(s,r),n||(s=r=null)))};return function(){for(var r=arguments.length,c=new Array(r),d=0;d<r;d++)c[d]=arguments[d];s=this,a=+new Date;var u=o&&!n;return n||(n=setTimeout(l,t)),u&&(i=e.apply(s,c),s=c=null),i}}function s(e,t){for(var o=Object.create(null),n=e.split(","),r=0;r<n.length;r++)o[n[r]]=!0;return t?function(e){return o[e.toLowerCase()]}:function(e){return o[e]}}var a="export default ",i={html:{indent_size:"2",indent_char:" ",max_preserve_newlines:"-1",preserve_newlines:!1,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"separate",brace_style:"end-expand",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!0,wrap_line_length:"110",indent_inner_html:!0,comma_first:!1,e4x:!0,indent_empty_lines:!0},js:{indent_size:"2",indent_char:" ",max_preserve_newlines:"-1",preserve_newlines:!1,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"normal",brace_style:"end-expand",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!0,end_with_newline:!0,wrap_line_length:"110",indent_inner_html:!0,comma_first:!1,e4x:!0,indent_empty_lines:!0}};function l(e){return e.replace(/( |^)[a-z]/g,(function(e){return e.toUpperCase()}))}function c(e){return/^[+-]?(0|([1-9]\d*))(\.\d+)?$/g.test(e)}function d(e,t){var o=null;return function(){var n=this,r=arguments;o&&clearTimeout(o),o=setTimeout((function(){e.apply(n,r)}),t)}}function u(e){var t;t=10===e.length?new Date(1e3*e):new Date(e);var o=t.getFullYear()+"-",n=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",r=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",s=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",a=(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":",i=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return o+n+r+s+a+i}function p(e){if(!e)return"";var t=e/1e3;if(t<60)return t.toFixed(0)+" 秒";var o=t/60;if(o<60)return o.toFixed(0)+" 分钟";var n=o/60;if(n<24)return n.toFixed(0)+" 小时";var r=n/24;if(r<30)return r.toFixed(0)+" 天";var s=r/30;if(s<12)return s.toFixed(0)+" 个月";var a=s/12;return a.toFixed(0)+" 年"}},f8ab:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));o("d3b7"),o("3ca3"),o("ddb0");var n=o("a66f"),r=o("2ef0"),s={computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return o.e("chunk-4701442f").then(o.bind(null,"6f25"))},businessTable:"test_demo"},{text:"请假单",routeName:"@/views/activiti/form/leaveForm",component:function(){return o.e("chunk-612ab04b").then(o.bind(null,"4f30"))},businessTable:"leave_form"}]},historyDetail:function(){return n["a"]}},methods:{getFormComponent:function(e){return Object(r["find"])(this.allFormComponent,{routeName:e})||{}}}}},fcb7:function(e,t,o){"use strict";o.d(t,"d",(function(){return r})),o.d(t,"e",(function(){return s})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return i})),o.d(t,"f",(function(){return l})),o.d(t,"b",(function(){return c}));var n=o("b775");function r(e){return Object(n["a"])({url:"/system/dept/list",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/system/dept/list/exclude/"+e,method:"get"})}function a(e){return Object(n["a"])({url:"/system/dept/"+e,method:"get"})}function i(e){return Object(n["a"])({url:"/system/dept",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/system/dept",method:"put",data:e})}function c(e){return Object(n["a"])({url:"/system/dept/"+e,method:"delete"})}}}]);