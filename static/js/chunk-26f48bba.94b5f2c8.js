(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26f48bba"],{2076:function(t,e,n){"use strict";var i=n("c7eb"),o=n("1da1"),a=n("2638"),r=n.n(a),s=n("5530"),l=(n("d81d"),n("b64b"),n("c740"),n("f092")),c=n("d4e0"),d=n("2ae7"),u=n("ed08");e["a"]={components:{normalTableRender:{functional:!0,name:"normal-table-render",render:function(t,e){return e.parent.tableRender(e)}},ProTable:l["a"],DialogForm:c["a"],ToobarButton:d["a"]},data:function(){return{selectionList:[],searchModel:{},searchConfig:[],toolbarConfig:[],actionConfig:[],tableColumns:[],tableProps:{},checkbox:!1,showIndex:!1,showToolbar:!0,pagination:!0,dialogTitle:"新增",dialogWidth:"600px",dialogLabelWidth:"80px",dialogVisible:!1,dialogFormConfig:[],formModel:{},formRules:{},tableData:null,dictHandle:Object(u["c"])(this.dictWithData,1e3)}},watch:{"dict.type":{handler:function(){this.dictHandle()},deep:!0}},methods:{tableRender:function(t){var e=this,n=this.$createElement,i=t.slots();return n("div",[n("pro-table",r()([{ref:"tableRef",attrs:{data:this.tableData,"search-model":this.searchModel,"search-config":this.searchConfig,"toolbar-config":this.toolbarConfig,"table-props":this.tableProps,"table-columns":this.tableColumns,checkbox:this.checkbox,request:this.request,showIndex:this.showIndex,showToolbar:this.showToolbar,pagination:this.pagination,resetHandle:this.resetHandle,searchHandle:this.searchHandle},on:{buttonClick:this.buttonClick,handleSelectionChange:this.handleSelectionChange}},{scopedSlots:Object(s["a"])({actions:function(t,i){return n("div",{style:{display:"flex","justify-content":"center",width:"100%"}},[n("toobar-button",{attrs:{config:e.actionConfig,data:i},on:{buttonClick:function(n){e.actionClick(n,i,t.$index)}}})])}},t.scopedSlots)}]),[Object.keys(i).map((function(t){return n("template",{slot:t},[i[t]])}))]),n("dialog-form",r()([{attrs:{title:this.dialogTitle,width:this.dialogWidth,"label-width":this.dialogLabelWidth,configs:this.dialogFormConfig,dialogVisible:this.dialogVisible,"form-model":this.formModel,"form-rules":this.formRules},on:{close:this.closeDialog,confirm:this.confirm}},{scopedSlots:t.scopedSlots}]))])},getDictValue:function(t,e){var n,i;return null!==(n=this.dict)&&void 0!==n&&n.type[t]?null===(i=this.dict)||void 0===i?void 0:i.label[t][e]:""},setDictValue:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"label",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"value";return null!==(e=this.dict)&&void 0!==e&&e.type[t]?null===(n=this.dict)||void 0===n?void 0:n.type[t].map((function(t){return{label:t[i],value:t[o]}})):[]},getOptionsByDict:function(t,e){var n=this.searchConfig.findIndex((function(e){return e.model===t}));-1!==n&&(this.searchConfig[n].options=this.setDictValue(e))},closeDialog:function(){this.dialogVisible=!1},confirm:function(t){this.dialogVisible=!1},reload:function(){this.selectionList=[],this.$refs.tableRef&&this.$refs.tableRef.reload()},request:function(){return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",{list:[],total:0});case 1:case"end":return t.stop()}}),t)})))()},buttonClick:function(){},handleSelectionChange:function(t){this.selectionList=t},dictWithData:function(){},actionClick:function(){},resetHandle:function(){},searchHandle:function(){}}}},"5c6f":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("normal-table-render"),n("Dialog",{attrs:{title:"审批历史",visible:t.modalLsVisible,footer:!1,width:"80%"},on:{close:function(e){t.modalLsVisible=!1}}},[n("historyDetail",{tag:"component",attrs:{procInstId:t.procInstId}})],1),n("Dialog",{attrs:{title:t.title,visible:t.visible,width:"50%",footer:!1},on:{close:function(e){t.visible=!1}}},[n(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew},on:{close:function(e){t.visible=!1}}})],1)],1)},o=[],a=n("c7eb"),r=n("1da1"),s=n("2076"),l=n("a66f"),c=n("9039"),d=n("ed08"),u=n("f8ab"),h=n("b775");function f(t){return Object(h["a"])({url:"/system/actTask/doneList",method:"get",params:t})}function p(t){return Object(h["a"])({url:"/system/actTask/deleteHistoric/".concat(t),method:"post"})}var m={name:"DoneManage",mixins:[s["a"],u["a"]],components:{HistoryDetail:l["a"],Dialog:c["a"]},data:function(){var t=this.$createElement;return{modalLsVisible:!1,visible:!1,procInstId:"",title:"",lcModa:{disabled:!1,formComponent:null,isNew:!1},searchConfig:[{type:"input",model:"name",label:"任务名称"}],actionConfig:[{label:"表单数据",icon:"el-icon-s-data",type:"text",action:"form"},{label:"审批历史",icon:"el-icon-time",type:"text",action:"history"},{label:"删除",icon:"el-icon-delete",type:"text",action:"del"}],tableColumns:[{key:"name",title:"任务名称",props:{width:"150",fixed:"left"}},{key:"processName",title:"所属流程",props:{width:"150"}},{key:"owner",title:"委托人",props:{width:"150"}},{key:"applyer",title:"流程发起人",props:{width:"150"}},{key:"priority",title:"优先级",props:{width:"110"},customRender:function(e,n){return t("div",[0===n.priority?t("span",{style:"color: green;"},[" 普通 "]):1===n.priority?t("span",{style:"color: orange;"},[" 重要 "]):2===n.priority?t("span",{style:"color: red;"},[" 紧急 "]):t("span",{style:"color: #999;"},[" 无 "])])}},{key:"deleteReason",title:"审批操作",props:{width:"150"}},{key:"comment",title:"审批意见",props:{width:"150"}},{key:"duration",title:"耗时",props:{width:"100"},customRender:function(e,n){return t("span",[Object(d["h"])(n.duration)])}},{key:"createTime",title:"创建时间",props:{width:"160"}},{key:"action",title:"操作",props:{align:"center",minWidth:"250",fixed:"right"},scopedSlots:{customRender:"actions"}}]}},methods:{request:function(t){return Object(r["a"])(Object(a["a"])().mark((function e(){var n;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f(t);case 2:return n=e.sent,e.abrupt("return",{list:n.data});case 4:case"end":return e.stop()}}),e)})))()},actionClick:function(t,e){var n=this;switch(t.action){case"del":this.$modal.confirm("确定删除吗?").then((function(t){p(e.id).then((function(t){n.reload(),n.$modal.msgSuccess("删除成功")}))})).catch((function(){}));break;case"history":if(!e.procInstId)return this.$modal.msgError("流程实例ID不存在");this.procInstId=e.procInstId,this.modalLsVisible=!0;break;case"form":if(!e.routeName)return this.$modal.msgError("该流程信息未配置表单，请联系开发人员！");this.lcModa.disabled=!0,this.lcModa.formComponent=this.getFormComponent(e.routeName).component,this.lcModa.processData=e,this.lcModa.isNew=!1,this.lcModa.isTask=!0,this.title="查看流程业务信息："+e.processName,this.visible=!0;break}}}},b=m,g=n("2877"),v=Object(g["a"])(b,i,o,!1,null,"8dc869d6",null);e["default"]=v.exports},a66f:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search"},[n("el-card",{staticStyle:{"margin-bottom":"10px"}},[n("p",{attrs:{slot:"header"},slot:"header"},[n("span",[t._v("流程审批进度历史")])]),n("el-row",{staticStyle:{position:"relative"}},[n("normal-table-render")],1)],1),n("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.callback},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{name:"1",label:"实时流程图"}},[n("el-card",[n("el-row",{staticStyle:{position:"relative"}},[n("img",{attrs:{src:t.imgUrl}})])],1)],1),t.lcModa?n("el-tab-pane",{attrs:{name:"2",label:"表单数据"}},[n("el-card",[n(t.lcModa.formComponent,{tag:"component",attrs:{disabled:t.lcModa.disabled,processData:t.lcModa.processData,isNew:t.lcModa.isNew,task:t.lcModa.isTask},on:{afterSubmit:t.afterSub,passTask:function(e){return t.pass(t.lcModa.processData)},backTask:function(e){return t.back(t.lcModa.processData)},close:function(e){t.lcModa.visible=!1,t.lcModa.disabled=!1}}})],1)],1):t._e()],1)],1)},o=[],a=n("c7eb"),r=n("1da1"),s=(n("a15b"),n("d81d"),n("d3b7"),n("25f0"),n("2076")),l=n("b775"),c=n("ed08"),d={name:"HistoryDetail",mixins:[s["a"]],props:{procInstId:{type:String,default:"",required:!0},lcModa:{type:Object,required:!1}},data:function(){var t=this.$createElement;return{activeName:"1",url:{historicFlow:"/system/actTask/historicFlow/",getHighlightImg:"/prod-api/system/activiti/models/getHighlightImg/"},type:0,loading:!1,loadingImg:!1,id:"",imgUrl:"",backRoute:"",pagination:!1,dialogVisible:!1,showToolbar:!1,tableColumns:[{key:"name",title:"任务名称"},{key:"assignees",title:"处理人",customRender:function(e,n){var i=n.assignees||[],o=i.map((function(t){return t.username})).join(",");return t("span",[o])}},{key:"deleteReason",title:"审批操作",customRender:function(e,n){return t("div",[n.deleteReason.toString().indexOf("通过")>-1?t("span",{style:"color: #00DB00"},[n.deleteReason]):n.deleteReason.toString().indexOf("驳回")>-1?t("span",{style:"color: red;"},[n.deleteReason]):t("span",[n.deleteReason])])}},{key:"comment",title:"审批意见"},{key:"duration",title:"耗时",customRender:function(e,n){return t("span",[Object(c["h"])(n.duration)])}},{key:"createTime",title:"创建时间",props:{width:160}},{key:"endTime",title:"完成时间",props:{width:160}},{key:"status",title:"状态",customRender:function(e,n){return t("div",[n.endTime?t("span",{style:"color: blue;"},["已办理"]):t("span",{style:"color: #999999"},["待处理"])])}}]}},created:function(){this.init()},watch:{procInstId:function(t,e){this.init()}},methods:{loadData:function(){},init:function(){this.id=this.procInstId,this.imgUrl=this.url.getHighlightImg+this.id+"?time="+new Date,this.reload()},request:function(){var t=this;return Object(r["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l["a"])({url:t.url.historicFlow+t.id,method:"get"}).then((function(e){return 200===e.code?e.data&&0!=e.data.length||t.$message.info("未找到该记录审批历史数据,历史数据可能已被删除"):t.$message.error(e.msg),{list:e.data||[],total:0}})));case 1:case"end":return e.stop()}}),e)})))()},callback:function(t,e){console.log(t,e,this.activeName)},afterSub:function(){},pass:function(t){this.$emit("passTask",t)},back:function(t){this.$emit("backTask",t)}}},u=d,h=n("2877"),f=Object(h["a"])(u,i,o,!1,null,null,null);e["a"]=f.exports},ed08:function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"j",(function(){return l})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"i",(function(){return u})),n.d(e,"h",(function(){return h}));n("53ca"),n("ac1f"),n("5319"),n("14d9"),n("a15b"),n("d81d"),n("b64b"),n("d3b7"),n("159b"),n("fb6a"),n("d9e2"),n("a630"),n("3ca3"),n("6062"),n("ddb0"),n("25f0"),n("466d"),n("4d63"),n("c607"),n("2c3e"),n("00b4"),n("b680"),n("c38a");function i(t){if(null==t||""==t)return"";var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate(),a=e.getHours()<10?"0"+e.getHours():e.getHours(),r=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return n+"-"+i+"-"+o+" "+a+":"+r+":"+s}function o(t,e,n){var i,o,a,r,s,l=function l(){var c=+new Date-r;c<e&&c>0?i=setTimeout(l,e-c):(i=null,n||(s=t.apply(a,o),i||(a=o=null)))};return function(){for(var o=arguments.length,c=new Array(o),d=0;d<o;d++)c[d]=arguments[d];a=this,r=+new Date;var u=n&&!i;return i||(i=setTimeout(l,e)),u&&(s=t.apply(a,c),a=c=null),s}}function a(t,e){for(var n=Object.create(null),i=t.split(","),o=0;o<i.length;o++)n[i[o]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}var r="export default ",s={html:{indent_size:"2",indent_char:" ",max_preserve_newlines:"-1",preserve_newlines:!1,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"separate",brace_style:"end-expand",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!0,wrap_line_length:"110",indent_inner_html:!0,comma_first:!1,e4x:!0,indent_empty_lines:!0},js:{indent_size:"2",indent_char:" ",max_preserve_newlines:"-1",preserve_newlines:!1,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"normal",brace_style:"end-expand",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!0,end_with_newline:!0,wrap_line_length:"110",indent_inner_html:!0,comma_first:!1,e4x:!0,indent_empty_lines:!0}};function l(t){return t.replace(/( |^)[a-z]/g,(function(t){return t.toUpperCase()}))}function c(t){return/^[+-]?(0|([1-9]\d*))(\.\d+)?$/g.test(t)}function d(t,e){var n=null;return function(){var i=this,o=arguments;n&&clearTimeout(n),n=setTimeout((function(){t.apply(i,o)}),e)}}function u(t){var e;e=10===t.length?new Date(1e3*t):new Date(t);var n=e.getFullYear()+"-",i=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",o=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ",a=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",r=(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":",s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return n+i+o+a+r+s}function h(t){if(!t)return"";var e=t/1e3;if(e<60)return e.toFixed(0)+" 秒";var n=e/60;if(n<60)return n.toFixed(0)+" 分钟";var i=n/60;if(i<24)return i.toFixed(0)+" 小时";var o=i/24;if(o<30)return o.toFixed(0)+" 天";var a=o/30;if(a<12)return a.toFixed(0)+" 个月";var r=a/12;return r.toFixed(0)+" 年"}},f8ab:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n("d3b7"),n("3ca3"),n("ddb0");var i=n("a66f"),o=n("2ef0"),a={computed:{allFormComponent:function(){return[{text:"示例表单",routeName:"@/views/activiti/form/demoForm",component:function(){return n.e("chunk-4701442f").then(n.bind(null,"6f25"))},businessTable:"test_demo"},{text:"请假单",routeName:"@/views/activiti/form/leaveForm",component:function(){return n.e("chunk-612ab04b").then(n.bind(null,"4f30"))},businessTable:"leave_form"}]},historyDetail:function(){return i["a"]}},methods:{getFormComponent:function(t){return Object(o["find"])(this.allFormComponent,{routeName:t})||{}}}}}}]);